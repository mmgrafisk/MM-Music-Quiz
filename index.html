<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Rock Quiz ‚Äì Lokal</title>
  <link rel="stylesheet" href="styles.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div id="app" class="container">
    <header class="header">
      <div class="brand">
        <div class="logo">üéµ</div>
        <div>
          <h1>Rock Quiz</h1>
          <p class="subtitle">Lokal musik‚Äëquiz med Spotify previews (ingen login)</p>
        </div>
      </div>
      <div class="controls">
        <button id="importBtn" class="btn ghost">Importer playlist</button>
        <button id="settingsBtn" class="btn ghost">Indstillinger</button>
        <button id="helpBtn" class="btn ghost">Hj√¶lp</button>
      </div>
    </header>

    <main class="grid">
      <section class="panel game">
        <div class="row">
          <div class="stack">
            <h2 id="roundTitle">Runde <span id="roundNo">1</span> / <span id="roundTotal">10</span></h2>
            <p id="statusLine" class="muted">Tryk Start for at spille et 30 sek preview.</p>
          </div>
          <div class="stack right">
            <div class="score">
              <span>Score:</span>
              <strong id="score">0</strong>
            </div>
            <div class="timer" aria-live="polite">
              ‚è±Ô∏è <span id="countdown">30</span>s
            </div>
          </div>
        </div>

        <div class="player">
          <audio id="audio" preload="auto"></audio>
          <div class="player-controls">
            <button id="startBtn" class="btn primary">Start runde</button>
            <button id="replayBtn" class="btn" disabled>‚ñ∂Ô∏é Afspil igen</button>
            <button id="skipBtn" class="btn" disabled>Spring over</button>
            <button id="revealBtn" class="btn warn" disabled>Vis svar</button>
          </div>
          <div id="nowPlaying" class="muted"></div>
        </div>

        <div id="choices" class="choices"></div>

        <div class="row">
          <div class="stack">
            <label class="inline">
              <input type="checkbox" id="hardMode">
              Hardcore (kun kunstnernavn vises)
            </label>
          </div>
          <div class="stack right">
            <button id="newGameBtn" class="btn ghost">Ny spil</button>
          </div>
        </div>
      </section>

      <section class="panel list">
        <div class="row">
          <h3>Track‚Äëpakke</h3>
          <div class="stack right">
            <button id="downloadBtn" class="btn" disabled>Download tracks.json</button>
          </div>
        </div>
        <p class="muted">Brug <em>Importer playlist</em> eller l√¶g en <code>tracks.json</code> i mappen.</p>
        <div id="trackList" class="tracklist"></div>
      </section>
    </main>

    <footer class="footer">
      <span>Lavet til lokal brug. Ingen login. Bruger Spotify <em>preview_url</em>.</span>
      <span>¬© 2025 Rock Quiz</span>
    </footer>
  </div>

  <!-- Settings -->
  <dialog id="settingsModal">
    <form method="dialog" class="modal">
      <h3>Indstillinger</h3>
      <label class="field">
        <span>Spotify token (valgfrit ‚Äì proxy bruges automatisk)</span>
        <input type="password" id="tokenInput" placeholder="Bearer token‚Ä¶">
      </label>
      <label class="field">
        <span>Antal runder</span>
        <input type="number" id="roundsInput" min="3" max="50" value="10">
      </label>
      <label class="field">
        <span>Tidsgr√¶nse (sekunder)</span>
        <input type="number" id="timeLimitInput" min="10" max="60" value="30">
      </label>
      <menu class="menu">
        <button value="cancel" class="btn ghost">Luk</button>
        <button id="saveSettingsBtn" value="default" class="btn primary">Gem</button>
      </menu>
      <p class="muted small">Token gemmes i din browser (localStorage). Hvis tomt, hentes automatisk fra <code>http://localhost:8787/token</code>.</p>
    </form>
  </dialog>

  <!-- Help -->
  <dialog id="helpModal">
    <form method="dialog" class="modal">
      <h3>Hj√¶lp</h3>
      <ol>
        <li>K√∏r den lokale token‚Äëproxy (se mappen <code>auto-token-proxy</code>).</li>
        <li>Klik <em>Importer playlist</em> for at hente tracks fra en offentlig Spotify‚Äëplaylist.</li>
        <li>Du kan ogs√• inds√¶tte et token manuelt i <em>Indstillinger</em>.</li>
      </ol>
      <p class="muted small">OBS: Ikke alle sange har <code>preview_url</code>.</p>
      <menu class="menu">
        <button value="default" class="btn primary">Luk</button>
      </menu>
    </form>
  </dialog>

  <!-- Importer playlist -->
  <dialog id="importModal">
    <form method="dialog" class="modal">
      <h3>Importer playlist</h3>
      <label class="field">
        <span>Playlist URL eller ID</span>
        <input type="text" id="playlistInput" placeholder="https://open.spotify.com/playlist/37i9dQZF... eller kun ID">
      </label>
      <menu class="menu">
        <button value="cancel" class="btn ghost">Luk</button>
        <button id="runImportBtn" value="default" class="btn primary">Importer</button>
      </menu>
      <p id="importStatus" class="muted small"></p>
    </form>
  </dialog>

  <script src="app.js" type="module"></script>
</body>
</html>
